<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The London Museum</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Header Section -->
    <header id="header">
        <div class="header-container">
            <!-- Left: Logo -->
            <div class="logo">
                <a href="index.html">
                    <img src="images/logo.png" alt="The London Museum">
                </a>
            </div>
            
            <!-- Center: Search Bar -->
            <div class="search-container">
                <input type="text" placeholder="Search artists, artworks...">
                <button>Search</button>
            </div>
                        
            <!-- Right: Navigation Menu -->
            <nav class="main-nav">
                <!-- Collections Dropdown -->
                <div class="dropdown">
                    <span class="dropdown-title">Collections</span>
                    <div class="dropdown-content">
                        <a href="artists.html">Browse all Artists</a>
                        <a href="artworks.html">Browse all Artworks</a>
                        <a href="search-collection.html">Search Collection</a>
                    </div>
                </div>
            
                <!-- Exhibitions Dropdown -->
                <div class="dropdown">
                    <span class="dropdown-title">Exhibitions & Events</span>
                    <div class="dropdown-content">
                        <a href="exhibitions.html">Current Exhibitions</a>
                        <a href="events.html">Events Calendar</a>
                        <a href="upcoming-exhibitions.html">Upcoming Exhibitions</a>
                    </div>
                </div>
            
                <!-- Shop Dropdown -->
                <div class="dropdown">
                    <span class="dropdown-title">Shop</span>
                    <div class="dropdown-content">
                        <a href="shop.html">Exhibition Merchandise</a>
                        <a href="gifts.html">Gifts & Souvenirs</a>
                        <a href="prints.html">Prints & Posters</a>
                    </div>
                </div>
            
                <!-- Visit Dropdown -->
                <div class="dropdown">
                    <span class="dropdown-title">Visit</span>
                    <div class="dropdown-content">
                        <a href="book-visit.html">Book your Visit</a>
                        <a href="cafe.html">Café & Facilities</a>
                        <a href="directions.html">Getting Here & Map</a>
                    </div>
                </div>
            </nav>
        </div>
    </header>
    
    <!-- Section 1: About Museum -->
    <section id="about-museum">
        <div class="about-container">
            <!-- Left: Text Content -->
            <div class="about-text">
                <h2>The London Museum</h2>
                <h3>Where Art Meets Perspective</h3>
                <p>Founded in the heart of London, our museum is dedicated to showcasing extraordinary talent and innovative artistic visions. We believe in making art accessible to all while celebrating the diverse voices that shape our cultural landscape.</p>
                <p>Through carefully curated exhibitions and rotating collections, we present works that challenge perspectives and inspire new ways of seeing. Each display is thoughtfully designed to create meaningful connections with our visitors.</p>
                <p>At The London Museum, we don't just display art - we create conversations between artists, visitors, and the world around us.</p>
            </div>
            
            <!-- Right: Image Slideshow -->
            <div class="about-slideshow">
                <img src="images/museum1.png" alt="London Museum exterior" class="slideshow-image active">
                <img src="images/museum2.png" alt="Gallery space" class="slideshow-image">
                <img src="images/museum3.png" alt="Visitor experience" class="slideshow-image">
                <img src="images/museum4.png" alt="Art display" class="slideshow-image">
                
                <!-- Navigation Arrows -->
                <button class="slideshow-nav slideshow-prev" aria-label="Previous image">‹</button>
                <button class="slideshow-nav slideshow-next" aria-label="Next image">›</button>
                
                <!-- Dot Indicators -->
                <div class="slideshow-dots">
                    <button class="dot active" data-slide="0" aria-label="Show image 1"></button>
                    <button class="dot" data-slide="1" aria-label="Show image 2"></button>
                    <button class="dot" data-slide="2" aria-label="Show image 3"></button>
                    <button class="dot" data-slide="3" aria-label="Show image 4"></button>
                </div>
                
                <!-- Pause Button -->
                <button class="slideshow-pause" aria-label="Pause slideshow">
                    <svg class="pause-icon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <rect x="6" y="4" width="4" height="16"></rect>
                        <rect x="14" y="4" width="4" height="16"></rect>
                    </svg>
                    <svg class="play-icon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="display: none;">
                        <polygon points="5,4 19,12 5,20"></polygon>
                    </svg>
                </button>
            </div>
        </div>
    </section>
        
    <!-- Section 2: Featured Artists -->
    <section id="featured-artists">
        [FEATURED ARTISTS WILL GO HERE]
    </section>
    
    <!-- Section 3: Artwork Preview -->
    <section id="artwork-preview">
        <div class="artwork-container">
            <h2 class="section-title">From the Collection</h2>
            
            <div class="artwork-carousel-wrapper">
                <!-- Navigation Arrows -->
                <button class="carousel-nav carousel-prev" aria-label="Previous artwork">‹</button>
                <button class="carousel-nav carousel-next" aria-label="Next artwork">›</button>
                
                <div class="artwork-carousel" id="artworkCarousel">
                    <!-- Artworks will be inserted by JavaScript -->
                </div>
            </div>
            
            <!-- Artwork Info -->
            <div class="centered-artwork-info">
                <h3 class="artwork-title" id="centered-artwork-title"></h3>
                <button class="view-collection-btn">View in Collection</button>
            </div>
        </div>
    </section>
    
    <!-- Section 4: Hero Banner -->
    <section id="hero">
        [HERO BANNER WILL GO HERE]
    </section>
    
    <!-- Footer Section -->
    <footer id="footer">
        [FOOTER WILL GO HERE]
    </footer>

    <script>
        // Museum Slideshow
        let currentSlide = 0;
        let slideInterval;
        const slides = document.querySelectorAll('.slideshow-image');
        const dots = document.querySelectorAll('.dot');
        const pauseButton = document.querySelector('.slideshow-pause');
        const pauseIcon = document.querySelector('.pause-icon');
        const playIcon = document.querySelector('.play-icon');
        const prevButton = document.querySelector('.slideshow-prev');
        const nextButton = document.querySelector('.slideshow-next');
        let isPlaying = true;

        function showSlide(n) {
            // Remove active class from current slide and mark it as leaving
            slides.forEach((slide, index) => {
                if (slide.classList.contains('active')) {
                    slide.classList.remove('active');
                    slide.classList.add('leaving');
                    setTimeout(() => {
                        slide.classList.remove('leaving');
                    }, 800);
                }
            });
            
            // Update dots
            dots.forEach(dot => dot.classList.remove('active'));
            dots[n].classList.add('active');
            
            // Add active class to new slide
            slides[n].classList.add('active');
            currentSlide = n;
        }

        function nextSlide() {
            let next = (currentSlide + 1) % slides.length;
            showSlide(next);
        }

        function prevSlide() {
            let prev = (currentSlide - 1 + slides.length) % slides.length;
            showSlide(prev);
        }

        function goToSlide(n) {
            showSlide(n);
            // Reset auto-advance timer when manually navigating
            if (isPlaying) {
                clearInterval(slideInterval);
                slideInterval = setInterval(nextSlide, 5000);
            }
        }

        function toggleSlideshow() {
            if (isPlaying) {
                clearInterval(slideInterval);
                pauseIcon.style.display = 'none';
                playIcon.style.display = 'block';
            } else {
                slideInterval = setInterval(nextSlide, 5000);
                pauseIcon.style.display = 'block';
                playIcon.style.display = 'none';
            }
            isPlaying = !isPlaying;
        }

        // Start the slideshow
        slideInterval = setInterval(nextSlide, 5000);

        // Event Listeners
        pauseButton.addEventListener('click', toggleSlideshow);
        nextButton.addEventListener('click', () => {
            nextSlide();
            if (isPlaying) {
                clearInterval(slideInterval);
                slideInterval = setInterval(nextSlide, 5000);
            }
        });
        prevButton.addEventListener('click', () => {
            prevSlide();
            if (isPlaying) {
                clearInterval(slideInterval);
                slideInterval = setInterval(nextSlide, 5000);
            }
        });

        // Dot navigation
        dots.forEach((dot, index) => {
            dot.addEventListener('click', () => goToSlide(index));
        });

        // ===== ARTWORK CAROUSEL =====
        const artworkImages = [
            { src: 'images/artworks/a-cry-for-nature.png', title: 'A Cry for Nature' },
            { src: 'images/artworks/bond-of-self.png', title: 'Bond of Self' },
            { src: 'images/artworks/eye.png', title: 'Eye' },
            { src: 'images/artworks/graphite-tears.png', title: 'Graphite Tears' },
            { src: 'images/artworks/grey-and-white.png', title: 'Grey and White' },
            { src: 'images/artworks/hand-with-refracting-sphere.png', title: 'Hand with Refracting Sphere' },
            { src: 'images/artworks/memory-orb-1.png', title: 'Memory Orb I' },
            { src: 'images/artworks/memory-orb-2.png', title: 'Memory Orb II' },
            { src: 'images/artworks/memory-orb-3.png', title: 'Memory Orb III' },
            { src: 'images/artworks/rayograph.png', title: 'Rayograph' },
            { src: 'images/artworks/self-creation.png', title: 'Self Creation' },
            { src: 'images/artworks/tears-of-the-past.png', title: 'Tears of the Past' },
            { src: 'images/artworks/the-persistence-of-time.png', title: 'The Persistence of Time' },
            { src: 'images/artworks/the-rhinos.png', title: 'The Rhinos' },
            { src: 'images/artworks/the-treachery-of-objects-1.png', title: 'The Treachery of Objects I' },
            { src: 'images/artworks/the-treachery-of-objects-2.png', title: 'The Treachery of Objects II' },
            { src: 'images/artworks/the-treachery-of-objects-3.png', title: 'The Treachery of Objects III' },
            { src: 'images/artworks/the-treachery-of-objects-4.png', title: 'The Treachery of Objects IV' }
        ];
        
        const carousel = document.getElementById('artworkCarousel');
        const centeredTitle = document.getElementById('centered-artwork-title');
        const centeredInfo = document.querySelector('.centered-artwork-info');
        const wrapper = document.querySelector('.artwork-carousel-wrapper');
        
        // Randomize order on page load
        const shuffledArtworks = [...artworkImages].sort(() => Math.random() - 0.5);
        
        // Create artwork items in random order
        shuffledArtworks.forEach((artwork, index) => {
            const artworkItem = document.createElement('div');
            artworkItem.className = 'artwork-item';
            artworkItem.dataset.index = index;
            
            const img = document.createElement('img');
            img.src = artwork.src;
            img.alt = artwork.title;
            img.className = 'artwork-image';
            
            artworkItem.appendChild(img);
            carousel.appendChild(artworkItem);
        });
        
        const artworkItems = document.querySelectorAll('.artwork-item');
        let scrollPosition = 0;
        let isPaused = false;
        let pauseTimeout;
        let currentCenteredIndex = -1;
        const scrollSpeed = 0.5;
        let animationId = null;
        
        // Store item widths as they load
        const itemWidths = new Array(artworkItems.length).fill(280); // Default width
        
        // Track loaded images
        let loadedImages = 0;
        const totalImages = artworkItems.length;
        
        artworkItems.forEach((item, index) => {
            const img = item.querySelector('img');
            img.onload = function() {
                // Calculate display width based on aspect ratio
                const aspectRatio = this.naturalWidth / this.naturalHeight;
                const displayHeight = 280; // CSS height
                const displayWidth = displayHeight * aspectRatio;
                
                itemWidths[index] = displayWidth;
                item.style.width = displayWidth + 'px';
                item.dataset.width = displayWidth;
                
                loadedImages++;
                if (loadedImages === totalImages) {
                    initializeCarousel();
                }
            };
            
            img.onerror = function() {
                // Use default width if image fails to load
                item.style.width = '280px';
                item.dataset.width = 280;
                
                loadedImages++;
                if (loadedImages === totalImages) {
                    initializeCarousel();
                }
            };
        });
        
        // Initialize carousel after images load
        function initializeCarousel() {
            // Calculate total width of first set
            let totalWidth = 0;
            artworkItems.forEach((item, index) => {
                totalWidth += itemWidths[index] + 40; // 40px gap
            });
            
            // Duplicate items for seamless loop - duplicate entire set
            const itemsToDuplicate = Array.from(artworkItems);
            itemsToDuplicate.forEach(item => {
                const clone = item.cloneNode(true);
                clone.style.width = item.style.width;
                carousel.appendChild(clone);
            });
            
            // Get all items including duplicates
            const allCarouselItems = document.querySelectorAll('.artwork-item');
            
            // Start the animation
            startCarousel(allCarouselItems, totalWidth);
        }
        
        function startCarousel(allCarouselItems, totalWidth) {
            let scrollPosition = 0;
            let isPaused = false;
            let pauseTimeout;
            let currentCenteredIndex = -1;
            
            function updateCarousel() {
                if (!isPaused) {
                    scrollPosition -= scrollSpeed;
                    carousel.style.transform = `translateX(${scrollPosition}px)`;
                    
                    // Reset position when scrolled through one full set
                    if (Math.abs(scrollPosition) >= totalWidth) {
                        scrollPosition += totalWidth;
                    }
                    
                    checkCenteredArtwork();
                }
                
                animationId = requestAnimationFrame(updateCarousel);
            }
            
            function checkCenteredArtwork() {
                const wrapperRect = wrapper.getBoundingClientRect();
                const wrapperCenterX = wrapperRect.left + wrapperRect.width / 2;
                
                // Find which original artwork should be centered
                let accumulatedWidth = 0;
                let foundIndex = -1;
                let closestDistance = Infinity;
                
                // Check only the first set (non-duplicated items)
                for (let i = 0; i < artworkItems.length; i++) {
                    const itemWidth = itemWidths[i] || 280;
                    const itemLeft = -scrollPosition + accumulatedWidth;
                    const itemCenterX = wrapperRect.left + itemLeft + itemWidth / 2;
                    const distance = Math.abs(itemCenterX - wrapperCenterX);
                    
                    if (distance < closestDistance && distance < 150) { // Increased threshold to 150px
                        closestDistance = distance;
                        foundIndex = i;
                    }
                    
                    accumulatedWidth += itemWidth + 40; // Add gap
                }
                
                // If an artwork is close to center and not currently centered
                if (foundIndex !== -1 && foundIndex !== currentCenteredIndex) {
                    pauseAtArtwork(foundIndex);
                }
            }
            
            function pauseAtArtwork(index) {
                if (isPaused) return;
                
                isPaused = true;
                currentCenteredIndex = index;
                
                // Calculate exact position to center this artwork
                const wrapperRect = wrapper.getBoundingClientRect();
                
                let accumulatedWidth = 0;
                for (let i = 0; i < index; i++) {
                    const itemWidth = itemWidths[i] || 280;
                    accumulatedWidth += itemWidth + 40; // Add gap
                }
                
                const targetWidth = itemWidths[index] || 280;
                const itemCenterOffset = accumulatedWidth + targetWidth / 2;
                const targetScroll = itemCenterOffset - wrapperRect.width / 2;
                
                // Smoothly scroll to center the artwork
                const startScroll = scrollPosition;
                const endScroll = -targetScroll;
                const duration = 300; // Reduced from 500ms for faster centering
                const startTime = performance.now();
                
                function smoothScroll(currentTime) {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    
                    // Easing function for smooth animation
                    const easeOutQuart = 1 - Math.pow(1 - progress, 4);
                    scrollPosition = startScroll + (endScroll - startScroll) * easeOutQuart;
                    carousel.style.transform = `translateX(${scrollPosition}px)`;
                    
                    if (progress < 1) {
                        requestAnimationFrame(smoothScroll);
                    } else {
                        // After centering, highlight and show info
                        highlightCenteredArtwork(index);
                    }
                }
                
                requestAnimationFrame(smoothScroll);
            }
            
            function highlightCenteredArtwork(index) {
                // Remove highlight from all items
                allCarouselItems.forEach(item => item.classList.remove('centered'));
                
                // Highlight the centered artwork in both original and duplicated sets
                allCarouselItems.forEach((item, carouselIndex) => {
                    if (carouselIndex % shuffledArtworks.length === index) {
                        item.classList.add('centered');
                    }
                });
                
                // Show info
                centeredTitle.textContent = shuffledArtworks[index].title;
                centeredInfo.classList.add('visible');
                
                // Resume after 5 seconds
                clearTimeout(pauseTimeout);
                pauseTimeout = setTimeout(() => {
                    isPaused = false;
                    centeredInfo.classList.remove('visible');
                    allCarouselItems.forEach(item => item.classList.remove('centered'));
                    currentCenteredIndex = -1;
                }, 5000);
            }
            
            // Start the carousel animation
            updateCarousel();
            
            // Fallback if initialization takes too long
            setTimeout(() => {
                if (animationId === null) {
                    initializeCarousel();
                }
            }, 2000);
        }
        
        // Start with a simple version if images take too long
        setTimeout(() => {
            if (animationId === null) {
                // Create a simplified version without width calculations
                const artworkItems = document.querySelectorAll('.artwork-item');
                artworkItems.forEach(item => {
                    item.style.width = '280px';
                });
                
                let totalWidth = artworkItems.length * (280 + 40);
                
                // Duplicate items
                const itemsToDuplicate = Array.from(artworkItems).slice(0, 5);
                itemsToDuplicate.forEach(item => {
                    const clone = item.cloneNode(true);
                    carousel.appendChild(clone);
                });
                
                const allCarouselItems = document.querySelectorAll('.artwork-item');
                startCarousel(allCarouselItems, totalWidth);
            }
        }, 3000);
        
        // Also initialize if all images load before timeout
        window.addEventListener('load', () => {
            if (!isInitialized) {
                initializeCarousel();
            }
        });
    </script>
</body>
</html>
